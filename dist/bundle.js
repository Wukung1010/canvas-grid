!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Grid=e():t.Grid=e()}(window,(function(){return function(t){var e={};function o(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);var i,n={size:[1,1],style:[1,1],color:["#17233d","#17233d"]},s={name:"微软雅黑",size:12,color:"#515a6e",isBold:!1,isItalic:!1,vertical:1,horizontal:0},l=function(){function t(t){this.borderSize=2,this.borderColor="#19be6b",this.scrollXCache=0,this.scrollYCache=0,this.el=t,this.createSelectBox()}return t.prototype.createSelectBox=function(){this.box=document.createElement("div"),this.box.style.cssText="\n      position: absolute;\n      display: none;\n      background: rgba(255, 255, 255, 0);\n      border: "+this.borderSize+"px solid "+this.borderColor+";\n      pointer-events: none;",this.el.appendChild(this.box)},t.prototype.move=function(t,e,o,i){var s,l,r,d,h,a;if(this.box){this.box.style.transition="all .3s",this.scrollXCache=o,this.scrollYCache=i,this.boundCache=t;var c=e.border;this.box.style.display="block",this.box.style.top=t.y-this.borderSize+"px",this.box.style.left=t.x-this.borderSize+"px",this.box.style.width=t.width-(null!=(r=null===(l=null===(s=c)||void 0===s?void 0:s.size)||void 0===l?void 0:l[0])?r:n.size[0])+"px",this.box.style.height=t.height-(null!=(a=null===(h=null===(d=c)||void 0===d?void 0:d.size)||void 0===h?void 0:h[1])?a:n.size[1])+"px"}},t.prototype.scrollRelocation=function(t,e){if(this.box&&"block"===this.box.style.display){this.box.style.transition="none";var o=t-this.scrollXCache,i=e-this.scrollYCache;this.box.style.left=this.boundCache.x-this.borderSize-o+"px",this.box.style.top=this.boundCache.y-this.borderSize-i+"px"}},t.prototype.close=function(){this.box&&(this.box.style.display="none")},t.prototype.destroy=function(){this.el&&this.box&&(this.el.removeChild(this.box),this.el=void 0,this.scrollXCache=0,this.scrollYCache=0,this.boundCache=void 0)},t}();!function(t){t[t.close=0]="close",t[t.editing=1]="editing"}(i||(i={}));var r=function(){function t(t){this.status=0,this.el=t,this.createEditor()}return t.prototype.createEditor=function(){this.editor=document.createElement("input"),this.editor.style.cssText="position: absolute; display: none; box-sizing: border-box; outline: none; border: 0px",this.el.appendChild(this.editor)},t.prototype.open=function(t,e,o,n){this.editor&&(this.status=i.editing,this.boundCache=t,this.editor.value=e,this.editor.style.display="block",this.editor.style.top=t.y+"px",this.editor.style.left=t.x+"px",this.editor.style.width=t.width-1+"px",this.editor.style.height=t.height-1+"px",this.editor.style.fontFamily=o,this.editor.style.fontSize=n+"px",this.editor.focus())},t.prototype.close=function(){if(this.editor)return this.status=i.close,this.boundCache=void 0,this.editor.style.display="none",this.editor.value},t.prototype.getEditorBound=function(){return this.boundCache},t.prototype.isEditing=function(){return this.status===i.editing},t.prototype.destroy=function(){this.el&&this.editor&&(this.el.removeChild(this.editor),this.el=void 0)},t}();var d,h,a={fitHighPixel:function(t){var e,o,i,n,s=t.getContext("2d"),l=null!=(e=window.devicePixelRatio)?e:1,r=t.width,d=t.height;t.width=Math.round(r*l),t.height=Math.round(d*l),t.style.width=r+"px",t.style.height=d+"px",null===(n=null===(o=s)||void 0===o?void 0:(i=o).scale)||void 0===n||n.call(i,l,l)},getTextSize:function(t,e,o){var i=document.createElement("span");i.style.cssText="display: inline-block; font-family: "+e+"; font-size: "+o+"px",i.innerText=t,document.body.appendChild(i);var n=i.getBoundingClientRect();return document.body.removeChild(i),n},getElAbsoluteOffset:function(t){for(var e={top:0,left:0},o=t;o&&o!==document.body;)"relative"!==o.style.position&&"absolute"!==o.style.position||(e.top+=o.offsetTop,e.left+=o.offsetLeft),o=o.parentElement;return e}},c=s;!function(t){t[t.top=0]="top",t[t.middle=1]="middle",t[t.bottom=2]="bottom"}(d||(d={})),function(t){t[t.left=0]="left",t[t.middle=1]="middle",t[t.right=2]="right"}(h||(h={}));var u,f={render:function(t,e,o,i,n,s,l){var r,a,u,f,p,v,x;void 0===l&&(l=c);var b=e,y=o,g=null!=(r=l.name)?r:c.name,m=null!=(a=l.size)?a:c.size,w=null!=(u=l.isBold)?u:c.isBold,C=null!=(f=l.isItalic)?f:c.isItalic,B=null!=(p=l.color)?p:c.color,E=null!=(v=l.horizontal)?v:c.horizontal,T=null!=(x=l.vertical)?x:c.vertical;t.font=(C?"italic":"")+" "+(w?"bold":"")+" "+m+"px "+g,t.fillStyle=B,T===d.top?t.textBaseline="top":T===d.bottom?(t.textBaseline="bottom",y=o+n):(t.textBaseline="middle",y=o+Math.ceil(n/2)),E===h.middle?(t.textAlign="center",b=e+Math.ceil(i/2)):E===h.right?(t.textAlign="right",b=e+i):t.textAlign="left",t.rect(e,o,i,n),t.clip(),t.fillText(s,b,y)}};!function(t){t[t.single=0]="single",t[t.dotted=1]="dotted"}(u||(u={}));var p=n,v=[4,4];function x(t,e,o,i){t.lineWidth=e,o===u.dotted?t.setLineDash(v):t.setLineDash([]),t.strokeStyle=i}var b={render:function(t,e,o,i,n,s){var l,r,d,h,a,c,u,f,v,b,y,g;void 0===s&&(s=p),x(t,null!=(r=null===(l=s.size)||void 0===l?void 0:l[0])?r:p.size[0],null!=(h=null===(d=s.style)||void 0===d?void 0:d[0])?h:p.style[0],null!=(c=null===(a=s.color)||void 0===a?void 0:a[0])?c:p.color[0]),t.beginPath();var m=e+i-t.lineWidth/2;t.moveTo(m,o),t.lineTo(m,o+n),t.stroke(),x(t,null!=(f=null===(u=s.size)||void 0===u?void 0:u[1])?f:p.size[1],null!=(b=null===(v=s.style)||void 0===v?void 0:v[1])?b:p.style[1],null!=(g=null===(y=s.color)||void 0===y?void 0:y[1])?g:p.color[1]),t.beginPath();var w=o+n-t.lineWidth/2;t.moveTo(e,w),t.lineTo(e+i,w),t.stroke()}},y=function(){function t(t,e){this.scrollTop=0,this.scrollLeft=0,this.renderArea={width:0,height:0},this.mouseMoving=!1,this.el=t,this.data=e,this.initEnv(),this.render(),this.registerListener()}return t.prototype.initEnv=function(){var t=this;this.selfBox=document.createElement("div"),this.selfBox.style.cssText="position: relative; height: 100%; overflow: hidden;",this.el.appendChild(this.selfBox);var e=this.selfBox.offsetWidth,o=this.selfBox.offsetHeight,i=this.data.rows.reduce((function(t,e){return t+e}),0),s=this.data.cols.reduce((function(t,e){return t+e}),0),d=!1,h=!1;i>o&&(h=!0,s>e-10&&(d=!0)),s>e&&(d=!0,i>o-10&&(h=!0));var c=o-(h?10:0),u=e-(d?10:0);this.canvasBox=document.createElement("div"),this.canvasBox.style.cssText="\n      position: relative;\n      float: left;\n      box-sizing: border-box;\n      border: 1px solid "+n.color[0]+";\n      width: "+u+"px;\n      height: "+c+"px;\n      overflow: hidden;\n    ",this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",""+(u-2)),this.canvas.setAttribute("height",""+(c-2)),this.canvasBox.appendChild(this.canvas),this.selfBox.appendChild(this.canvasBox);var f="\n      position: relative;\n      background: #e6e6e6;\n      border: 1px solid #d8d8d8;\n      box-sizing: border-box;\n      border-radius: 3px;\n      overflow: hidden;\n    ",p="\n      position: relative;\n      border: 0px;\n      background: #ffffff;\n      cursor: pointer;\n      border-radius: 3px;\n    ";if(h){var v=!1,x={top:0,left:0},b=0,y=c,g=document.createElement("div");g.style.cssText="\n        "+f+"\n        float: right;\n        width: 10px;\n        height: "+c+"px;\n      ";var m=document.createElement("div"),w=c/i;m.style.cssText="\n        "+p+"\n        width: 8px;\n        height: "+Math.floor(c*w)+"px;\n      ",m.addEventListener("mousedown",(function(t){v=!0,b=t.offsetY,t.stopPropagation(),t.preventDefault()})),document.body.addEventListener("mousemove",(function(e){if(v){var o=e.y-x.top-b;o<0?o=0:o>y&&(o=y),m.style.top=o+"px",t.scrollTop=o/w,t.render(),t.select.scrollRelocation(t.scrollLeft,t.scrollTop)}})),document.body.addEventListener("mouseup",(function(t){v=!1,b=0})),g.appendChild(m),this.selfBox.appendChild(g),x=a.getElAbsoluteOffset(g),y-=m.offsetHeight}if(d){var C=!1,B={top:0,left:0},E=0,T=u,z=document.createElement("div");z.style.cssText="\n        "+f+"\n        clear: both;\n        width: "+u+"px;\n        height: 10px;\n      ";var L=document.createElement("div"),S=u/s;L.style.cssText="\n        "+p+"\n        width: "+Math.floor(u*S)+"px;\n        height: 8px;\n      ",L.addEventListener("mousedown",(function(t){C=!0,E=t.offsetX,t.stopPropagation(),t.preventDefault()})),document.body.addEventListener("mousemove",(function(e){if(C){var o=e.x-B.left-E;o<0?o=0:o>T&&(o=T),L.style.left=o+"px",t.scrollLeft=o/S,t.render(),t.select.scrollRelocation(t.scrollLeft,t.scrollTop)}})),document.body.addEventListener("mouseup",(function(t){C=!1,E=0})),z.appendChild(L),this.selfBox.appendChild(z),B=a.getElAbsoluteOffset(z),T-=L.offsetWidth}this.renderArea.width=this.canvas.offsetWidth,this.renderArea.height=this.canvas.offsetHeight,this.select=new l(this.canvasBox),this.editor=new r(this.canvasBox),a.fitHighPixel(this.canvas)},t.prototype.render=function(){var t=this.canvas.getContext("2d");if(t){for(var e=-this.scrollLeft,o=-this.scrollTop,i=0,n=0;e+this.data.cols[n]<0;)e+=this.data.cols[n],n+=1;for(;o+this.data.rows[i]<0;)o+=this.data.rows[i],i+=1;for(var s=e,l=o,r=i;r<this.data.rows.length&&!(this.renderArea.height<l);r+=1){for(var d=this.data.rows[r],h=n;h<this.data.cols.length&&!(this.renderArea.width<s);h+=1){var a=this.data.cells[r][h],c=this.data.cols[h];this.renderCell(t,s,l,c,d,a),s+=c}l+=d,s=e}}},t.prototype.renderCell=function(t,e,o,i,n,s){t.save(),t.clearRect(e,o,i,n),b.render(t,e,o,i,n,s.border),f.render(t,e,o,i,n,s.showText,s.font),t.restore()},t.prototype.getCellBound=function(t,e){var o={rowIndex:0,colIndex:0,x:0,y:0,height:0,width:0},i=t+this.scrollLeft;this.data.cols.some((function(t,e){return o.x<=i&&o.x+t>=i?(o.width=t,o.colIndex=e,!0):(o.x+=t,!1)})),o.x-=this.scrollLeft;var n=e+this.scrollTop;return this.data.rows.some((function(t,e){return o.y<=n&&o.y+t>=n?(o.height=t,o.rowIndex=e,!0):(o.y+=t,!1)})),o.y-=this.scrollTop,o},t.prototype.getCell=function(t,e){return this.data.cells[e][t]},t.prototype.registerListener=function(){var t=this;this.selfBox.addEventListener("mousedown",(function(e){if(e.target===t.canvas){var o=e.offsetX,i=e.offsetY,n=t.getCellBound(o,i);if(t.editor.isEditing()){var s=t.editor.getEditorBound(),l=t.editor.close(),r=t.getCell(s.colIndex,s.rowIndex);r.showText=l,r.editText=l,t.render()}t.select.move(n,t.getCell(n.colIndex,n.rowIndex),t.scrollLeft,t.scrollTop)}}),!0),this.selfBox.addEventListener("mousemove",(function(e){if(t.mouseMoving){var o=e.offsetX,i=e.offsetY;t.getCellBound(o,i)}}),!0),this.selfBox.addEventListener("mouseup",(function(){t.mouseMoving=!1}),!0),this.selfBox.addEventListener("dblclick",(function(e){var o,i,n=e.offsetX,l=e.offsetY,r=t.getCellBound(n,l),d=t.getCell(r.colIndex,r.rowIndex);t.editor.open(r,d.editText,(null===(o=d.font)||void 0===o?void 0:o.name)||s.name,(null===(i=d.font)||void 0===i?void 0:i.size)||s.size)}),!0)},t}();e.default=y}]).default}));